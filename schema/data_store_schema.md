# EchoSMs anatomical datastore schema

This schema defines a structure for storing fish and plankton acoustic scattering model data, mainly for input to the echoSMs anatomical datastore.

The reference version of the schema (formatted as a JSON-schema file) will always be available in the echoSMs github [repository](https://github.com/ices-tools-dev/echoSMs/tree/main/data_store/schema).

## Specimen
The specimen properties are:

|Property|Required|Description|Type|Constraints|
|---|---|---|---|---|
|uuid|yes|A Universally Unique IDentifier for this specimen as per [RFC9562](https://datatracker.ietf.org/doc/rfc9562). Generated by the datastore.|string||
|version_number|yes|A version number that increments whenever this specimen is updated. Generated and updated by the datastore.|integer|minimum: 1|
|version_time|yes|The timestamp when this specimen dataset was last modified, in [RFC9557](https://datatracker.ietf.org/doc/rfc9557) format, including the timezone. Generated and updated by the datastore.|string||
|version_note|yes|A note about the changes in this version.|string||
|version_investigators|no|Names or identifying descriptions of persons or organisations that updated or created this dataset.|array of string|<br>|
|dataset_uuid|no|A Universally Unique IDentifier for a dataset as [RFC9562](https://datatracker.ietf.org/doc/rfc9562). Datasets are used only to group multiple specimens together. They contain no information that is not already in the specimen metadata.|string||
|dataset_name|no|A name for the dataset.|string||
|description|yes|A description of the specimen.|array of string|<br>|
|anatomical_category|yes|The type of anatomy that this dataset contains.|enum of string|one of ``tissue``, ``organ``, ``organ system``, ``organism``, ``other``|
|aphia_id|yes|The WoRMS [aphiaID](https://www.marinespecies.org/aphia.php) of the species in this dataset.|integer|minimum: 1|
|class|no|Taxonomical hierarchy level of class that is consistent with WoRMS.|string||
|order|no|Taxonomical hierarchy level of order that is consistent with WoRMS.|string||
|family|no|Taxonomical hierarchy level of family that is consistent with WoRMS.|string||
|genus|no|Taxonomical hierarchy level of genus that is consistent with WoRMS.|string||
|species|no|Taxonomical hierarchy level of species that is consistent with WoRMS.|string||
|vernacular_names|no|Vernacular names for the organism.|array of string|<br>|
|reference|no|A literature reference for the dataset. If available, a DOI or URI is recommended.|string||
|activity_name|no|Name of the data collection activity (if any), such as voyage code, project name, etc.|string||
|location|no|Name or description of the location where organism was collected.|string||
|latitude|no|Latitude of location where organism was collected.|number|minimum: -90<br>maximum: 90|
|latitude_units|yes, if ``latitude`` is present|Units for latitude. Positive values indicate north of the equator.|enum of string|must be: ``degrees_north``|
|longitude|no|Longitude of location where organism was collected.|number|minimum: -180<br>maximum: 180|
|longitude_units|yes, if ``longitude`` is present|Units for longitude. Positive values indicate east of the prime meridian.|enum of string|must be: ``degrees_east``|
|depth|no|Depth below surface of organism collection location.|number|minimum: 0|
|depth_units|yes, if ``depth`` is present|Units for depth.|enum of string|must be: ``m``|
|date_collection|yes|The date or date range when the dataset was collected, in [RFC9557](https://datatracker.ietf.org/doc/rfc9557) format.|string||
|date_image|yes|The date when the dataset was imaged, in [RFC9557](https://datatracker.ietf.org/doc/rfc9557) format.|string||
|data_collection_description|no|Description of data collection details.|string||
|notes|no|Explanatory notes about the shape data.|array of string|<br>|
|imaging_method|yes|Method used to obtain the raw image data.|enum of string|one of ``radiograph``, ``CT``, ``MRI``, ``photograph``, ``3D scanner``, ``unknown``, ``other``, ``not applicable``|
|shape_method|yes|Method used to obtain the specimen shape.|enum of string|one of ``manual outline of image(s)``, ``automated outline of images(s)``, ``3D scan of object``, ``not applicable``, ``unknown``, ``other``|
|shape_method_processing|no|Description of processing used to convert raw images into shapes, including any manipulation of image data (for example, smoothing, edge enhancement, rotation, etc).|string||
|straightened|yes|Was the shape straightened during the processing.|boolean||
|smoothed|yes|Was the shape smoothed during the processing.|boolean||
|rotated|yes|Was the shape rotated during the processing.|boolean||
|model_type|no|Original scattering model type.|enum of string|one of ``KRM``, ``KA``, ``DWBA``, ``PTDWBA``, ``FEM``, ``BEM``, ``MFS``, ``other``, ``unknown``, ``none``|
|sound_speed_method|no|Method used to obtain sound speed in the feature.|enum of string|one of ``density to sound speed relationship``, ``time-of-flight``, ``literature``, ``unknown``, ``other``|
|mass_density_method|no|Method used to obtain density in the feature.|enum of string|one of ``CT density``, ``liquid displacement``, ``literature``, ``unknown``, ``other``|
|dataset_size|yes|Size of the entire dataset (including raw data). Generated by the datastore server.|number|minimum: 0|
|dataset_size_units|yes|Units for dataset_size. Generated by the datastore server.|enum of string|must be: ``megabyte``|
|radiograph_perspective|no|The viewpoint of the imaging x-ray machine to the anatomical feature.|enum of object|one of ``lateral``, ``dorsal``, ``other``|
|radiograph_exposure_time|no|The exposure time setting of the imaging x-ray machine.|string||
|radiograph_exposure_time_unit|no|Unit of exposure time.|enum of string|must be: ``s``|
|radiograph_focal_length|no|Focal length setting of the imaging x-ray machine.|string||
|radiograph_focal_length_unit|no|Unit of focal length.|enum of string|must be: ``m``|
|radiograph_kVp|no|The kilovoltage peak setting of the imaging x-ray machine.|number||
|radiograph_mA|no|The milliamperage setting of the imaging x-ray machine.|number||
|specimen_name|yes|A name that identifies the specimen.|string||
|specimen_condition|yes|Condition of the specimen when it was imaged.|enum of string|one of ``fresh``, ``frozen``, ``thawed``, ``unknown``, ``other``|
|length|yes|Length of the specimen.|number|minimum: 0|
|length_units|yes|Units for lengths, dimensions, and sizes.|enum of string|must be: ``m``|
|weight|no|Weight of the specimen.|number|minimum: 0|
|weight_units|yes, if ``weight`` is present|Units for weight.|enum of string|must be: ``kg``|
|sex|no|Sex of specimen|enum of string|one of ``female``, ``male``, ``immature``, ``unknown``|
|length_type|yes|Type of length measurement.|enum of string|one of ``total length``, ``fork length``, ``standard length``, ``lower jaw fork length``, ``total width``, ``carapace length``, ``curved fork length``, ``disc width``, ``stretched total length``, ``CCAMLR krill - front of eye to tip of telson``, ``unknown``, ``other``|
|shape_type|yes|Type of shape data used for this specimen.|enum of string|one of ``outline``, ``surface``, ``voxels``, ``categorised voxels``|
|shapes|yes|Shape data.|Array of object|minItems: 1|

## Shapes




The ``shapes`` properties are:


|Property|Required|Description|Type|Constraints|
|---|---|---|---|---|
|name|no|Name for the shape.|string||
|anatomical_feature|yes|Type of anatomical feature represented by this shape.|enum of string|one of ``body``, ``swimbladder``, ``backbone``, ``bone``, ``muscle``, ``head``, ``eye``, ``organs``, ``appendages``, ``inclusion``, ``other``|

and includes these properties as per the value of ``shape_type``


=== "``outline``"


    |Property|Required|Description|Type|Constraints|
    |---|---|---|---|---|
    |shape_units|yes|Units for lengths, dimensions, and sizes.|enum of string|must be: ``m``|
    |boundary|yes|Type of reflecting boundary for this shape.|enum of string|one of ``fixed-rigid``, ``pressure-release``, ``fluid-filled``, ``elastic``|
    |x|yes|x-coordinate of shape centreline.|array of number|minItems: 1<br>|
    |y|yes|y-coordinate of shape centreline.|array of number|minItems: 1<br>|
    |z|yes|z-coordinate of shape centreline.|array of number|minItems: 1<br>|
    |height|yes|Height of the shape at each centreline point.|array of number|minItems: 1<br>minimum: 0|
    |width|yes|Width of the shape at each centreline point.|array of number|minItems: 1<br>minimum: 0|
    |mass_density|no|Mass density of shape.|array of number|minItems: 1<br>minimum: 0|
    |mass_density_units|yes, if ``mass_density`` is present|Units for mass density.|enum of string|must be: ``kg/m^3``|
    |sound_speed_compressional|no|Compressional sound speed in shape.|array of number|minItems: 1<br>minimum: 0|
    |sound_speed_compressional_units|yes, if ``sound_speed_compressional`` is present|Units for sound speed.|enum of string|must be: ``m/s``|
    |sound_speed_shear|no|Transversal (shear) sound speed in shape.|array of number|minItems: 1<br>minimum: 0|
    |sound_speed_shear_units|yes, if ``sound_speed_shear`` is present|Units for sound speed.|enum of string|must be: ``m/s``|
    |mass_density_ratio|no|Ratio of mass densities of the shape and the surrounding material or shape.|array of number|minItems: 1<br>minimum: 0|
    |sound_speed_ratio|no|Ratio of compressional sound speed of the and the surrounding material or shape.|array of number|minItems: 1<br>minimum: 0|
    |youngs_modulus|no|Young's modulus, E, of the shape.|array of number|minItems: 1<br>minimum: 0|
    |youngs_modulus_units|yes, if ``youngs_modulus`` is present|Units for Young's modulus.|enum of string|must be: ``Pa``|


=== "``surface``"


    |Property|Required|Description|Type|Constraints|
    |---|---|---|---|---|
    |shape_units|yes|Units for lengths, dimensions, and sizes.|enum of string|must be: ``m``|
    |boundary|yes|Type of reflecting boundary for this shape.|enum of string|one of ``fixed-rigid``, ``pressure-release``, ``fluid-filled``, ``elastic``|
    |x|yes|x-coordinates of surface nodes.|array of number|minItems: 1<br>|
    |y|yes|y-coordinates of surface nodes.|array of number|minItems: 1<br>|
    |z|yes|z-coordinates of surface nodes.|array of number|minItems: 1<br>|
    |facets_0|yes|Zero-based indices into x, y, and z that define node 0 of a surface triangle.|array of integer|minItems: 1<br>minimum: 0|
    |facets_1|yes|Zero-based indices into x, y, and z that define node 1 of a surface triangle.|array of integer|minItems: 1<br>minimum: 0|
    |facets_2|yes|Zero-based indices into x, y, and z that define node 2 of a surface triangle.|array of integer|minItems: 1<br>minimum: 0|
    |normals_x|yes|x-component of outward-pointing normal vector for each facet.|array of number|minItems: 1<br>|
    |normals_y|yes|y-component of outward-pointing normal vector for each facet.|array of number|minItems: 1<br>|
    |normals_z|yes|z-component of outward-pointing normal vector for each facet.|array of number|minItems: 1<br>|
    |mass_density|no|Mass density of shape.|number|minimum: 0|
    |mass_density_units|yes, if ``mass_density`` is present|Units for mass density.|enum of string|must be: ``kg/m^3``|
    |sound_speed_compressional|no|Compressional sound speed in shape.|number|minimum: 0|
    |sound_speed_compressional_units|yes, if ``sound_speed_compressional`` is present|Units for sound speed.|enum of string|must be: ``m/s``|
    |sound_speed_shear|no|Transversal (shear) sound speed in shape.|number|minimum: 0|
    |sound_speed_shear_units|yes, if ``sound_speed_shear`` is present|Units for sound speed.|enum of string|must be: ``m/s``|
    |mass_density_ratio|no|Ratio of mass densities of the shape and the surrounding material or shape.|number|minimum: 0|
    |sound_speed_ratio|no|Ratio of compressional sound speed of the and the surrounding material or shape.|number|minimum: 0|
    |youngs_modulus|no|Young's modulus, E, of the shape.|number|minimum: 0|
    |youngs_modulus_units|yes, if ``youngs_modulus`` is present|Units for Young's modulus.|enum of string|must be: ``Pa``|


=== "``voxels``"


    |Property|Required|Description|Type|Constraints|
    |---|---|---|---|---|
    |voxel_size|yes|Voxel size, ordered x, y, z.|array of number|minItems: 3<br>maxItems: 3<br>minimum: 0|
    |voxel_size_units|yes|Units for lengths, dimensions, and sizes.|enum of string|must be: ``m``|
    |mass_density|yes|Mass density of voxels.|array of array of array of number|minItems: 1<br>minItems: 1<br>minItems: 1<br>minimum: 0|
    |mass_density_units|yes|Units for mass density.|enum of string|must be: ``kg/m^3``|
    |sound_speed_compressional|yes|Compressional sound speed of voxels.|array of array of array of number|minItems: 1<br>minItems: 1<br>minItems: 1<br>minimum: 0|
    |sound_speed_compressional_units|yes|Units for sound speed.|enum of string|must be: ``m/s``|


=== "``categorised voxels``"


    |Property|Required|Description|Type|Constraints|
    |---|---|---|---|---|
    |voxel_size|yes|Voxel size, ordered x, y, z.|array of number|minItems: 3<br>maxItems: 3<br>minimum: 0|
    |voxel_size_units|yes|Units for lengths, dimensions, and sizes.|enum of string|must be: ``m``|
    |categories|yes|Voxel categories|array of array of array of integer|minItems: 1<br>minItems: 1<br>minItems: 1<br>minimum: 0|
    |mass_density|yes|Mass density of voxels categories.|array of number|minItems: 1<br>minimum: 0|
    |mass_density_units|yes|Units for mass density.|enum of string|must be: ``kg/m^3``|
    |sound_speed_compressional|yes|Compressional sound speed of voxel categories.|array of number|minItems: 1<br>minimum: 0|
    |sound_speed_compressional_units|yes|Units for sound speed.|enum of string|must be: ``m/s``|

