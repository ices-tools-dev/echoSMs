rem  A1.4.2raytraceBC REM	SECTION A1.4.2 RAYTRACE PRGM P381-382 REM	BASIC COMPILER VERSION  REM	    PRGM RAYTRACE. CSC   REM	  PRGM HAS EXTRAS TO HANDLE INCIDENT ANGLES BEYOND  REM	  CRITICAL WITHOUT HANGUPS. OUTPUT NUMBERS FOR REM	  INTERFACES BEYOND CRITICAL ARE MEANINGLESS. REM	  X(I)=9999999, T(I)=9999999 	  PRINT "RAYTRACE: AFTER LAYER INPUTS,"	  PRINT "PRGM RETURNS FOR NEW INCIDENT"	  PRINT "ANGLES"	    PRINT 	  DIM C(10),H(10),X(10),Z(10) REM	  COMPUTE PI=4*ATN(1) AND DEG TO RAD FACTOR, DR	  DR = 4 *  ATN (1) / 180	  Q = -1	  PRINT "INPUT NUMBER OF LAYERS=";	  INPUT N1	  	  FOR I = 1 TO N1	      PRINT "LAYER ";I;" INPUT C(I),H(I)=";:INPUT C(I),H(I)	  NEXT I	            PRINT  400	  PRINT "INPUT INCIDENT ANGLE=";: INPUT ANG	  REM	GOTO RAYTRACE SUBPROGRAM	GOSUB 800 	PRINT "I"; TAB( 5);"Z(I)"; TAB( 11);"X(I)"; TAB( 24);"T(I)"  	PRINT   	FOR I = 1 TO N1  	    PRINT I; TAB( 5);Z(I); TAB( 11);X(I); TAB( 24);T(I)  	NEXT I  		PRINT "HARD COPY 'y' or 'n'";: INPUT HC$	IF HC$="N" OR HC$="n" GOTO 500   LPRINT   LPRINT "INCIDENT ANGLE = ";ANG   LPRINT   LPRINT"I";TAB(5);"C(I)";TAB(12);"H(I)";TAB(20);"Z(I)";TAB(27);               LPRINT "X(I)";TAB( 40);"T(I)"  	LPRINT   	FOR I = 1 TO N1   LPRINT I;TAB(5);C(I);TAB(12);H(I);TAB(20);Z(I); TAB(27);               LPRINT X(I); TAB(40);T(I)  	NEXT I	   REM  	RETURN FOR NEW ANGLE500  	PRINT "FOR NEW ANGLE INPUT 'y'"  	INPUT C$  	IF C$ = "Y" OR C$ = "y" THEN 400600	  	END 	800	REM RAYTRACE SUBPROGRAM REM	SET INITIAL T, Z, X = 0	T = 0: Z = 0: X = 0 	I1 = ANG * DR 	P =  SIN (I1) / C(1) 	FOR I = 1 TO N1 	    A = P * C(I)              REM TEST FOR BEYOND CRITICAL REFL	   	    IF  ABS (A) < 1 AND Q < 1 THEN	      Q = -1	      B =  SQR (1 - A * A) 	      Z = Z + H(I) 	      Z(I) = Z 	      X = X + A * H(I) / B 	      X(I) = X 	      T = T + H(I) / (B * C(I))	      T(I) = T  	    ELSEIF ABS (A) >= 1 THEN	        Q = 1	        PRINT "BEYOND CRITICAL:LAYER ";I 	        X(I) = 9999999 	        T(I) = 9999999	    END IF	 NEXT I	RETURN