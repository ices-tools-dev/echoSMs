REM	SEISMIC UTILITIES APPENDIX B1.5.1 eureka test modAREM	PRGM TEST EUREKA.CSCREM   	ROBINSON CALLED HIS PRGM TO DO THE INVERSION 'EUREKA'.REM	I LIKE THE NAME.	DIM R(50),G(50),GI(50),FZ(50),FZ1(50),AZ(50),AZ1(50)	DIM ID(50),TESTG(50) REM     R(j) HAS TOEPLITZ FORM.R(j), j = 0 TO Li.R(j) ARE AUTOCORRELATIONS.REM	GI(j) ARE DESIRED OUTPUT. F(j) ARE FILTER COEF. A(j) ARE SOLNREM	OF A(j)*R(j,k)=(1,0,0,...).REM   	PRGM USES NORMAN LEVINSON'S RECURSIVE ALGORITHM.REM   	REF:J.F. CLAERBOUT 'FUNDIMENTALS OF DATA PROCESSING'REM	P 53-57.BLACKWELL SCI. PUB.1985REM   	REF:E.A.ROBINSON & S.TREITEL 'GEOPHYSICAL SIGNAL ANALYSIS' REM	P 163-169.PRENTCICE-HALL INC. 1980	PRINT "   TEST OF EUREKA FOR INPUTS OF R(j) AND GI(j) "	PRINT "WHERE THE LINEAR EQUATIONS HAVE THE TOEPLITZ FORM"	PRINT "    ALTHOUGH THE R(j) ACTUALLY HAVE TWO DIMENSIONS R(i,j), "	PRINT "THE i DEPENDENCE CAN BE SUPRESSED BECAUSE R(i,j) = R(i,-j)"	PRINT "AND ALL OF THE R(i,j) ONLY HAVE Li VALUES FOR Li EQUATIONS."	PRINT "PRGM USES INPUT OF R(j) AND G(j) TO COMPUTE F(j)."	PRINT "   IT COMPUTES AN INVERSE OF R(j), A(j).	PRINT "THE TEST CONSISTS OF COMPARING THE TEST G(j) AND INITIAL GI(j)"	PRINT	PRINT "INPUT DATA FOR FILTER COMPUTION"	PRINT  TAB( 5);"INDICES 0 TO Li. Li=";: INPUT Li	PRINT "INPUT G(j)	FOR j = 0 TO Li 	    PRINT j;:INPUT G(j)	    GI(j) = G(j) 	NEXT j	PRINT "INPUT R(j)	FOR j=0 TO Li	    PRINT j;:INPUT R(j)	NEXT j		GOSUB 1000: REM  DO SUB EUREKA	REM  	OUTPUTS 	PRINT " j      A(j)     F(j)/F(0),F(0)=";FZ(0)		FOR j = 0 TO Li	    PRINT j; TAB( 6);AZ(j); TAB( 21);FZ(j) / FZ(0)	NEXT j	INPUT Q$ : REM PAUSE	PRINT 	PRINT "CHECK A(j)*R(j) SHOULD BE (1,0,...)"	PRINT 	PRINT " j    A(j)*R(j)"		V = 0 	FOR j = 0 TO Li	    V = V + AZ(j) * R(j)	NEXT j		FOR j = 0 TO Li	    S = 0	        FOR i = 0 TO Li	            k =  ABS (j - i)	            S = S + AZ(i) * R(k)	        NEXT i	        ID(j) = S/V	    PRINT j; TAB( 6);ID(j)	NEXT j	INPUT Q$	PRINT 	PRINT "CHECK F(j). R(j)*F(j)=G(j)"	PRINT 	PRINT " j   TEST G(j)           ORIG G(j)"		FOR j = 0 TO Li	    S = 0	        FOR i = 0 TO Li	            k =  ABS (j - i)	            S = S + FZ(i) * R(k)	        NEXT i		TESTG(j) = S	    PRINT j; TAB( 6);TESTG(j); TAB( 23);GI(j)	NEXT j	INPUT Q$	GOTO 3000		1000	REM   PRGM EUREKA.CSCREM     ARRAY AZ(j) TRANSFERS TO AZ1(j) AFTER EACH LOOP ON L. REM  	THE FIRST STEP IS FOR L=0 	AZ(0) = 1	FZ(0) = G(0) / R(0)	AL = R(0)	GM = FZ(0) * R(1)	BT = R(1)	K =  - BT / AL		FOR L = 1 TO Li	    AZ1(0) = AZ(O)	    	        FOR J = 1 TO L - 1	            AZ1(J) = AZ(J) + K * AZ(L - J)	        NEXT J			    AZ1(L) = K * AZ(0)	    AL1 = AL + K * BT	    REM  FOR BETA	    BT1 = 0	    	    FOR J = 0 TO L	        BT1 = BT1 + AZ1(J) * R(L + 1 - J)	    NEXT J	    	    K1 =  - BT1 / AL1	    Q = (G(L) - GM) / AL1	    	    FOR J = 0 TO L - 1	        FZ1(J) = FZ(J) + Q * AZ1(L - J)	    NEXT J	    	    FZ1(L) = Q * AZ1(0)REM  	    GAMMA	    GM1 = 0	                FOR J = 0 TO L                GM1 = GM1 + FZ1(J) * R(L + 1 - J)            NEXT J	    REM   	SLIDE COEFFICIENTS	    FOR J = 0 TO L	        AZ(J) = AZ1(J)                FZ(J) = FZ1(J)	    NEXT J	    REM  	SLIDE	    AL = AL1	    BT = BT1	    K = K1	    GM = GM1REM  	REPEAT FOR NEW L	NEXT L 	RETURN : REM  RETURN TO DISPLAY RESULTS	3000	REM  FILE MAKER	print"give file name":input n$	open n$ for output as #1 		write #1, "Test of eureka: input R(j) and GI(j)"		for j=0 to Li	    write #1,j,R(j),GI(j)	next j	write #1, " Calculations" 	write #1," j       A(j)     F(j)/F(0)"		FOR j = 0 TO Li	    write#1,j,AZ(j),FZ(j) / FZ(0)	NEXT j		write #1,"F(0) = ";FZ(0)	write #1,"Check A(j)*R(j) should be (1,0,...)"	 	write #1," j    A(j)*R(j)"			FOR j = 0 TO Li	    	    write #1,j,ID(j)	NEXT j	 	write #1,"Check F(j). R(j)*F(j) = G(j)" 	write #1," j   TEST G(j)           ORIG G(j)"		FOR j = 0 TO Li	    write #1,j,TESTG(j),GI(j)	NEXT j	close #1	END